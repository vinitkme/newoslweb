(function(e,t,r,s){'use strict';r.editorConfiguration={addedFeature:function(t){e(s).trigger('drupalEditorFeatureAdded',t)},removedFeature:function(t){e(s).trigger('drupalEditorFeatureRemoved',t)},modifiedFeature:function(t){e(s).trigger('drupalEditorFeatureModified',t)},featureIsAllowedByFilters:function(e){function g(t){var o=['attributes','styles','classes'],i={};for(var s=0;s<t.rules.length;s++){var e=t.rules[s],r=e.required.tags;for(var n=0;n<r.length;n++){i[r[n]]={tag:!1,touchedByAllowedPropertyRule:!1,touchedBytouchedByForbiddenPropertyRule:!1}};if(a(e.required)){continue};for(var l=0;l<o.length;l++){var u=o[l];for(var f=0;f<e.required[u].length;f++){var d=e.required[u];i[r][u+':'+d]=!1}}};return i};function a(t){return t.attributes.length===0&&t.classes.length===0&&t.styles.length===0};function i(e,r,i,s,a){if(r==='*'){return d(e,i,s,a)};var n=!1;t.each(s,function(t){if(h(e,r,i,t,a)){n=!0}});return n};function d(e,r,a,s){var n=!1;t.each(t.keys(e),function(t){if(i(e,t,r,a,s)){n=!0}});return n};function h(e,r,i,s,a){if(!t.has(e,r)){return!1};var n=i+':'+s;if(a){e[r].touchedByAllowedPropertyRule=!0};if(t.indexOf(s,'*')===-1){if(t.has(e,r)&&t.has(e[r],n)){if(a){e[r][n]=!0};return!0};return!1}
else{var l=!1,u=n.replace(/\*/g,'[^ ]*');t.each(t.keys(e[r]),function(t){if(t.match(u)){l=!0;if(a){e[r][t]=!0}}});return l}};function s(e,r){if(r==='*'){return o(e)};if(t.has(e,r)&&t.every(t.omit(e[r],'touchedByAllowedPropertyRule'))){delete e[r];return!0};return!1};function o(e){var r=!1;t.each(t.keys(e),function(t){if(s(e,t)){r=!0}});return r};function u(e,r){var d=['attributes','styles','classes'],g=t.keys(e),s;for(var l=0;l<r.rules.length;l++){s=r.rules[l];if(s.allow===!1){if(t.intersection(g,s.tags).length>0){return!0}}};for(var n=0;n<r.rules.length;n++){s=r.rules[n];if(s.restrictedTags.tags.length&&!a(s.restrictedTags.forbidden)){for(var u=0;u<s.restrictedTags.tags.length;u++){var c=s.restrictedTags.tags[u];for(var o=0;o<d.length;o++){var f=d[o];if(i(e,c,f,s.restrictedTags.forbidden[f],!1)){return!0}}}}};return!1};function f(e,r){var h=['attributes','styles','classes'],n,l;for(var o=0;!t.isEmpty(e)&&o<r.rules.length;o++){n=r.rules[o];if(n.allow===!0){for(var u=0;!t.isEmpty(e)&&u<n.tags.length;u++){l=n.tags[u];if(t.has(e,l)){e[l].tag=!0;s(e,l)}}}};for(var f=0;!t.isEmpty(e)&&f<r.rules.length;f++){n=r.rules[f];if(n.restrictedTags.tags.length&&!a(n.restrictedTags.allowed)){for(var c=0;!t.isEmpty(e)&&c<n.restrictedTags.tags.length;c++){l=n.restrictedTags.tags[c];for(var d=0;d<h.length;d++){var g=h[d];if(i(e,l,g,n.restrictedTags.allowed[g],!0)){s(e,l)}}}}}};function l(e,r){if(!e.active){return!0};if(r.rules.length===0){return!0};if(e.rules.length===0){return!0};var s=g(r);if(u(s,e)){return!1};f(s,e);if(t.some(t.pluck(e.rules,'allow'))){if(t.isEmpty(s)){return!0}
else{if(!t.every(t.pluck(s,'tag'))){return!1}
else{var n=t.keys(s);for(var a=0;a<n.length;a++){var i=n[a];if(t.has(s,i)){if(s[i].touchedByAllowedPropertyRule===!1){delete s[i]}}};return t.isEmpty(s)}}}
else{return!0}};r.filterConfiguration.update();for(var n in r.filterConfiguration.statuses){if(r.filterConfiguration.statuses.hasOwnProperty(n)){var c=r.filterConfiguration.statuses[n];if(!(l(c,e))){return!1}}};return!0}};r.EditorFeatureHTMLRule=function(){this.required={tags:[],attributes:[],styles:[],classes:[]};this.allowed={tags:[],attributes:[],styles:[],classes:[]};this.raw=null};r.EditorFeature=function(t){this.name=t;this.rules=[]};r.EditorFeature.prototype.addHTMLRule=function(t){this.rules.push(t)};r.FilterStatus=function(t){this.name=t;this.active=!1;this.rules=[]};r.FilterStatus.prototype.addHTMLRule=function(t){this.rules.push(t)};r.FilterHTMLRule=function(){this.tags=[];this.allow=null;this.restrictedTags={tags:[],allowed:{attributes:[],styles:[],classes:[]},forbidden:{attributes:[],styles:[],classes:[]}};return this};r.FilterHTMLRule.prototype.clone=function(){var t=new r.FilterHTMLRule();t.tags=this.tags.slice(0);t.allow=this.allow;t.restrictedTags.tags=this.restrictedTags.tags.slice(0);t.restrictedTags.allowed.attributes=this.restrictedTags.allowed.attributes.slice(0);t.restrictedTags.allowed.styles=this.restrictedTags.allowed.styles.slice(0);t.restrictedTags.allowed.classes=this.restrictedTags.allowed.classes.slice(0);t.restrictedTags.forbidden.attributes=this.restrictedTags.forbidden.attributes.slice(0);t.restrictedTags.forbidden.styles=this.restrictedTags.forbidden.styles.slice(0);t.restrictedTags.forbidden.classes=this.restrictedTags.forbidden.classes.slice(0);return t};r.filterConfiguration={statuses:{},liveSettingParsers:{},update:function(){for(var t in r.filterConfiguration.statuses){if(r.filterConfiguration.statuses.hasOwnProperty(t)){r.filterConfiguration.statuses[t].active=e('[name="filters['+t+'][status]"]').is(':checked');if(r.filterConfiguration.liveSettingParsers[t]){r.filterConfiguration.statuses[t].rules=r.filterConfiguration.liveSettingParsers[t].getRules()}}}}};r.behaviors.initializeFilterConfiguration={attach:function(t,s){var i=e(t);i.find('#filters-status-wrapper input.form-checkbox').once('filter-editor-status').each(function(){var i=e(this),s=i.attr('name'),t=s.substring(8,s.indexOf(']'));r.filterConfiguration.statuses[t]=new r.FilterStatus(t)})}}})(jQuery,_,Drupal,document);