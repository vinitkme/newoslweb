(function(t){var n,r,e;n=(function(){function e(e,n,i){var r;this.row=e;this.tree=n;this.settings=i;this.id=this.row.data(this.settings.nodeIdAttr);r=this.row.data(this.settings.parentIdAttr);if(r!=null&&r!==""){this.parentId=r};this.treeCell=t(this.row.children(this.settings.columnElType)[this.settings.column]);this.expander=t(this.settings.expanderTemplate);this.indenter=t(this.settings.indenterTemplate);this.children=[];this.initialized=!1;this.treeCell.prepend(this.indenter)};e.prototype.addChild=function(t){return this.children.push(t)};e.prototype.ancestors=function(){var e,t;t=this;e=[];while(t=t.parentNode()){e.push(t)};return e};e.prototype.collapse=function(){if(this.collapsed()){return this};this.row.removeClass("expanded").addClass("collapsed");this._hideChildren();this.expander.attr("title",this.settings.stringExpand);if(this.initialized&&this.settings.onNodeCollapse!=null){this.settings.onNodeCollapse.apply(this)};return this};e.prototype.collapsed=function(){return this.row.hasClass("collapsed")};e.prototype.expand=function(){if(this.expanded()){return this};this.row.removeClass("collapsed").addClass("expanded");if(this.initialized&&this.settings.onNodeExpand!=null){this.settings.onNodeExpand.apply(this)};if(t(this.row).is(":visible")){this._showChildren()};this.expander.attr("title",this.settings.stringCollapse);return this};e.prototype.expanded=function(){return this.row.hasClass("expanded")};e.prototype.hide=function(){this._hideChildren();this.row.hide();return this};e.prototype.isBranchNode=function(){if(this.children.length>0||this.row.data(this.settings.branchAttr)===!0){return!0}
else{return!1}};e.prototype.updateBranchLeafClass=function(){this.row.removeClass("branch");this.row.removeClass("leaf");this.row.addClass(this.isBranchNode()?"branch":"leaf")};e.prototype.level=function(){return this.ancestors().length};e.prototype.parentNode=function(){if(this.parentId!=null){return this.tree[this.parentId]}
else{return null}};e.prototype.removeChild=function(e){var n=t.inArray(e,this.children);return this.children.splice(n,1)};e.prototype.render=function(){var r,e=this.settings,n;if(e.expandable===!0&&this.isBranchNode()){r=function(n){t(this).parents("table").treetable("node",t(this).parents("tr").data(e.nodeIdAttr)).toggle();return n.preventDefault()};this.indenter.html(this.expander);n=e.clickableNodeNames===!0?this.treeCell:this.expander;n.off("click.treetable").on("click.treetable",r);n.off("keydown.treetable").on("keydown.treetable",function(t){if(t.keyCode==13){r.apply(this,[t])}})};this.indenter[0].style.paddingLeft=""+(this.level()*e.indent)+"px";return this};e.prototype.reveal=function(){if(this.parentId!=null){this.parentNode().reveal()};return this.expand()};e.prototype.setParent=function(t){if(this.parentId!=null){this.tree[this.parentId].removeChild(this)};this.parentId=t.id;this.row.data(this.settings.parentIdAttr,t.id);return t.addChild(this)};e.prototype.show=function(){if(!this.initialized){this._initialize()};this.row.show();if(this.expanded()){this._showChildren()};return this};e.prototype.toggle=function(){if(this.expanded()){this.collapse()}
else{this.expand()};return this};e.prototype._hideChildren=function(){var i,t,r,n,e;n=this.children;e=[];for(t=0,r=n.length;t<r;t++){i=n[t];e.push(i.hide())};return e};e.prototype._initialize=function(){var t=this.settings;this.render();if(t.expandable===!0&&t.initialState==="collapsed"){this.collapse()}
else{this.expand()};if(t.onNodeInitialized!=null){t.onNodeInitialized.apply(this)};return this.initialized=!0};e.prototype._showChildren=function(){var i,t,r,n,e;n=this.children;e=[];for(t=0,r=n.length;t<r;t++){i=n[t];e.push(i.show())};return e};return e})();r=(function(){function e(t,e){this.table=t;this.settings=e;this.tree={};this.nodes=[];this.roots=[]};e.prototype.collapseAll=function(){var i,t,r,n,e;n=this.nodes;e=[];for(t=0,r=n.length;t<r;t++){i=n[t];e.push(i.collapse())};return e};e.prototype.expandAll=function(){var i,t,r,n,e;n=this.nodes;e=[];for(t=0,r=n.length;t<r;t++){i=n[t];e.push(i.expand())};return e};e.prototype.findLastNode=function(t){if(t.children.length>0){return this.findLastNode(t.children[t.children.length-1])}
else{return t}};e.prototype.loadRows=function(e){var r,s,i;if(e!=null){for(i=0;i<e.length;i++){s=t(e[i]);if(s.data(this.settings.nodeIdAttr)!=null){r=new n(s,this.tree,this.settings);this.nodes.push(r);this.tree[r.id]=r;if(r.parentId!=null&&this.tree[r.parentId]){this.tree[r.parentId].addChild(r)}
else{this.roots.push(r)}}}};for(i=0;i<this.nodes.length;i++){r=this.nodes[i].updateBranchLeafClass()};return this};e.prototype.move=function(e,n){var r=e.parentNode();if(e!==n&&n.id!==e.parentId&&t.inArray(e,n.ancestors())===-1){e.setParent(n);this._moveRows(e,n);if(e.parentNode().children.length===1){e.parentNode().render()}};if(r){r.updateBranchLeafClass()};if(e.parentNode()){e.parentNode().updateBranchLeafClass()};e.updateBranchLeafClass();return this};e.prototype.removeNode=function(e){this.unloadBranch(e);e.row.remove();if(e.parentId!=null){e.parentNode().removeChild(e)};delete this.tree[e.id];this.nodes.splice(t.inArray(e,this.nodes),1);return this};e.prototype.render=function(){var r,t,n,e;e=this.roots;for(t=0,n=e.length;t<n;t++){r=e[t];r.show()};return this};e.prototype.sortBranch=function(t,e){t.children.sort(e);this._sortChildRows(t);return this};e.prototype.unloadBranch=function(t){var n=t.children.slice(0),e;for(e=0;e<n.length;e++){this.removeNode(n[e])};t.children=[];t.updateBranchLeafClass();return this};e.prototype._moveRows=function(t,e){var r=t.children,n;t.row.insertAfter(e.row);t.render();for(n=r.length-1;n>=0;n--){this._moveRows(r[n],t)}};e.prototype._sortChildRows=function(t){return this._moveRows(t,t)};return e})();e={init:function(e,n){var i;i=t.extend({branchAttr:"ttBranch",clickableNodeNames:!1,column:0,columnElType:"td",expandable:!1,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},e);return this.each(function(){var s=t(this),e;if(n||s.data("treetable")===undefined){e=new r(this,i);e.loadRows(this.rows).render();s.addClass("treetable").data("treetable",e);if(i.onInitialized!=null){i.onInitialized.apply(e)}};return s})},destroy:function(){return this.each(function(){return t(this).removeData("treetable").removeClass("treetable")})},collapseAll:function(){this.data("treetable").collapseAll();return this},collapseNode:function(t){var e=this.data("treetable").tree[t];if(e){e.collapse()}
else{throw new Error("Unknown node '"+t+"'")};return this},expandAll:function(){this.data("treetable").expandAll();return this},expandNode:function(t){var e=this.data("treetable").tree[t];if(e){if(!e.initialized){e._initialize()};e.expand()}
else{throw new Error("Unknown node '"+t+"'")};return this},loadBranch:function(e,n){var s=this.data("treetable").settings,r=this.data("treetable").tree;n=t(n);if(e==null){this.append(n)}
else{var i=this.data("treetable").findLastNode(e);n.insertAfter(i.row)};this.data("treetable").loadRows(n);n.filter("tr").each(function(){r[t(this).data(s.nodeIdAttr)].show()});if(e!=null){e.render().expand()};return this},move:function(t,e){var r,n;n=this.data("treetable").tree[t];r=this.data("treetable").tree[e];this.data("treetable").move(n,r);return this},node:function(t){return this.data("treetable").tree[t]},removeNode:function(t){var e=this.data("treetable").tree[t];if(e){this.data("treetable").removeNode(e)}
else{throw new Error("Unknown node '"+t+"'")};return this},reveal:function(t){var e=this.data("treetable").tree[t];if(e){e.reveal()}
else{throw new Error("Unknown node '"+t+"'")};return this},sortBranch:function(e,n){var i=this.data("treetable").settings,s,r;n=n||i.column;r=n;if(t.isNumeric(n)){r=function(e,r){var s,a,i;s=function(e){var r=e.row.find("td:eq("+n+")").text();return t.trim(r).toUpperCase()};a=s(e);i=s(r);if(a<i)return-1;if(a>i)return 1;return 0}};this.data("treetable").sortBranch(e,r);return this},unloadBranch:function(t){this.data("treetable").unloadBranch(t);return this}};t.fn.treetable=function(n){if(e[n]){return e[n].apply(this,Array.prototype.slice.call(arguments,1))}
else if(typeof n==="object"||!n){return e.init.apply(this,arguments)}
else{return t.error("Method "+n+" does not exist on jQuery.treetable")}};this.TreeTable||(this.TreeTable={});this.TreeTable.Node=n;this.TreeTable.Tree=r})(jQuery);