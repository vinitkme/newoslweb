(function(e,i){'use strict';var t=i.states={postponed:[]};i.behaviors.states={attach:function(i,r){var o=e(i).find('[data-drupal-states]'),n,a,l=o.length;for(var s=0;s<l;s++){n=JSON.parse(o[s].getAttribute('data-drupal-states'));for(a in n){if(n.hasOwnProperty(a)){new t.Dependent({element:e(o[s]),state:t.State.sanitize(a),constraints:n[a]})}}}
while(t.postponed.length){(t.postponed.shift())()}}};t.Dependent=function(t){e.extend(this,{values:{},oldValue:null},t);this.dependees=this.getDependees();for(var i in this.dependees){if(this.dependees.hasOwnProperty(i)){this.initializeDependee(i,this.dependees[i])}}};t.Dependent.comparisons={RegExp:function(e,t){return e.test(t)},Function:function(e,t){return e(t)},Number:function(e,t){return(typeof t==='string')?n(e.toString(),t):n(e,t)}};t.Dependent.prototype={initializeDependee:function(i,r){var n,o=this;function a(e){o.update(e.data.selector,e.data.state,e.value)};this.values[i]={};for(var s in r){if(r.hasOwnProperty(s)){n=r[s];if(e.inArray(n,r)===-1){continue};n=t.State.sanitize(n);this.values[i][n.name]=null;e(i).on('state:'+n,{selector:i,state:n},a);new t.Trigger({selector:i,state:n})}}},compare:function(e,i,r){var s=this.values[i][r.name];if(e.constructor.name in t.Dependent.comparisons){return t.Dependent.comparisons[e.constructor.name](e,s)}
else{return n(e,s)}},update:function(e,t,i){if(i!==this.values[e][t.name]){this.values[e][t.name]=i;this.reevaluate()}},reevaluate:function(){var e=this.verifyConstraints(this.constraints);if(e!==this.oldValue){this.oldValue=e;e=s(e,this.state.invert);this.element.trigger({type:'state:'+this.state,value:e,trigger:!0})}},verifyConstraints:function(t,i){var r;if(e.isArray(t)){var l=e.inArray('xor',t)===-1,u=t.length;for(var n=0;n<u;n++){if(t[n]!=='xor'){var o=this.checkConstraints(t[n],i,n);if(o&&(l||r)){return l};r=r||o}}}
else if(e.isPlainObject(t)){for(var s in t){if(t.hasOwnProperty(s)){r=a(r,this.checkConstraints(t[s],i,s));if(r===!1){return!1}}}};return r},checkConstraints:function(e,i,r){if(typeof r!=='string'||(/[0-9]/).test(r[0])){r=null}
else if(typeof i==='undefined'){i=r;r=null};if(r!==null){r=t.State.sanitize(r);return s(this.compare(e,i,r),r.invert)}
else{return this.verifyConstraints(e,i)}},getDependees:function(){var e={};var t=this.compare;this.compare=function(t,i,r){(e[i]||(e[i]=[])).push(r.name)};this.verifyConstraints(this.constraints);this.compare=t;return e}};t.Trigger=function(i){e.extend(this,i);if(this.state in t.Trigger.states){this.element=e(this.selector);if(!this.element.data('trigger:'+this.state)){this.initialize()}}};t.Trigger.prototype={initialize:function(){var e=t.Trigger.states[this.state];if(typeof e==='function'){e.call(window,this.element)}
else{for(var i in e){if(e.hasOwnProperty(i)){this.defaultTrigger(i,e[i])}}};this.element.data('trigger:'+this.state,!0)},defaultTrigger:function(i,r){var n=r.call(this.element);this.element.on(i,e.proxy(function(e){var t=r.call(this.element,e);if(n!==t){this.element.trigger({type:'state:'+this.state,value:t,oldValue:n});n=t}},this));t.postponed.push(e.proxy(function(){this.element.trigger({type:'state:'+this.state,value:n,oldValue:null})},this))}};t.Trigger.states={empty:{keyup:function(){return this.val()===''}},checked:{change:function(){var t=!1;this.each(function(){t=e(this).prop('checked');return!t});return t}},value:{keyup:function(){if(this.length>1){return this.filter(':checked').val()||!1};return this.val()},change:function(){if(this.length>1){return this.filter(':checked').val()||!1};return this.val()}},collapsed:{collapsed:function(e){return(typeof e!=='undefined'&&'value' in e)?e.value:!this.is('[open]')}}};t.State=function(e){this.pristine=this.name=e;var i=!0;do{while(this.name.charAt(0)==='!'){this.name=this.name.substring(1);this.invert=!this.invert};if(this.name in t.State.aliases){this.name=t.State.aliases[this.name]}
else{i=!1}}
while(i);};t.State.sanitize=function(e){if(e instanceof t.State){return e}
else{return new t.State(e)}};t.State.aliases={enabled:'!disabled',invisible:'!visible',invalid:'!valid',untouched:'!touched',optional:'!required',filled:'!empty',unchecked:'!checked',irrelevant:'!relevant',expanded:'!collapsed',open:'!collapsed',closed:'collapsed',readwrite:'!readonly'};t.State.prototype={invert:!1,toString:function(){return this.name}};var r=e(document);r.on('state:disabled',function(t){if(t.trigger){e(t.target).prop('disabled',t.value).closest('.js-form-item, .js-form-submit, .js-form-wrapper').toggleClass('form-disabled',t.value).find('select, input, textarea').prop('disabled',t.value)}});r.on('state:required',function(t){if(t.trigger){if(t.value){var r='label'+(t.target.id?'[for='+t.target.id+']':''),i=e(t.target).attr({'required':'required','aria-required':'aria-required'}).closest('.js-form-item, .js-form-wrapper').find(r);if(!i.hasClass('js-form-required').length){i.addClass('js-form-required form-required')}}
else{e(t.target).removeAttr('required aria-required').closest('.js-form-item, .js-form-wrapper').find('label.js-form-required').removeClass('js-form-required form-required')}}});r.on('state:visible',function(t){if(t.trigger){e(t.target).closest('.js-form-item, .js-form-submit, .js-form-wrapper').toggle(t.value)}});r.on('state:checked',function(t){if(t.trigger){e(t.target).prop('checked',t.value)}});r.on('state:collapsed',function(t){if(t.trigger){if(e(t.target).is('[open]')===t.value){e(t.target).find('> summary').trigger('click')}}});function a(e,t){if(typeof e==='undefined'){return t}
else if(typeof t==='undefined'){return e}
else{return e&&t}};function s(e,t){return(t&&typeof e!=='undefined')?!e:e};function n(e,t){if(e===t){return typeof e==='undefined'?e:!0}
else{return typeof e==='undefined'||typeof t==='undefined'}}})(jQuery,Drupal);