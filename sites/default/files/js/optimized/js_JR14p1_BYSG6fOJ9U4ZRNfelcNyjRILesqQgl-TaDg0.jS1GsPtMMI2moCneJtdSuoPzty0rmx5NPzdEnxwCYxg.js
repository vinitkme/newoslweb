(function(o,t,r,e){'use strict';t.ckeditor.KeyboardView=r.View.extend({initialize:function(){this.$el.on('keydown.ckeditor','.ckeditor-buttons a, .ckeditor-multiple-buttons a',this.onPressButton.bind(this));this.$el.on('keydown.ckeditor','[data-drupal-ckeditor-type="group"]',this.onPressGroup.bind(this))},render:function(){},onPressButton:function(i){var u=[38,63232,40,63233],k=[37,63234,39,63235];if(i.keyCode===13){i.stopPropagation()};if(e.indexOf(e.union(u,k),i.keyCode)>-1){var g=this,a=o(i.currentTarget),r=a.parent(),n=r.parent(),d=r.closest('.ckeditor-toolbar-group'),c=r.closest('.ckeditor-row'),p=n.data('drupal-ckeditor-button-sorting'),y=this.$el.find('[data-drupal-ckeditor-button-sorting="source"]'),f=this.$el.find('.ckeditor-toolbar-active'),b=d,l;if(p==='source'){if(e.indexOf([40,63233],i.keyCode)>-1){f.find('.ckeditor-toolbar-group-buttons').eq(0).prepend(r)}}
else if(p==='target'){if(e.indexOf(k,i.keyCode)>-1){var h=n.children(),s=h.index(r);if(e.indexOf([37,63234],i.keyCode)>-1){if(s>0){r.insertBefore(n.children().eq(s-1))}
else{d=n.parent().prev();if(d.length>0){d.find('.ckeditor-toolbar-group-buttons').append(r)}
else{n.closest('.ckeditor-row').prev().find('.ckeditor-toolbar-group').not('.placeholder').find('.ckeditor-toolbar-group-buttons').eq(-1).append(r)}}}
else if(e.indexOf([39,63235],i.keyCode)>-1){if(s<(h.length-1)){r.insertAfter(n.children().eq(s+1))}
else{n.parent().next().find('.ckeditor-toolbar-group-buttons').prepend(r)}}}
else if(e.indexOf(u,i.keyCode)>-1){l=(e.indexOf([38,63232],i.keyCode)>-1)?'prev':'next';c=n.closest('.ckeditor-row')[l]();if(l==='prev'&&c.length===0){if(r.data('drupal-ckeditor-type')==='separator'){r.off().remove();f.find('.ckeditor-toolbar-group-buttons').eq(0).children().eq(0).children().trigger('focus')}
else{y.prepend(r)}}
else{c.find('.ckeditor-toolbar-group-buttons').eq(0).prepend(r)}}}
else if(p==='dividers'){if(e.indexOf([40,63233],i.keyCode)>-1){r=r.clone(!0);f.find('.ckeditor-toolbar-group-buttons').eq(0).prepend(r);a=r.children()}};g=this;t.ckeditor.registerButtonMove(this,r,function(e){if(!e&&b){b.find('.ckeditor-buttons').append(r)}
else{g.$el.find('.ui-sortable').sortable('refresh')};a.trigger('focus')});i.preventDefault();i.stopPropagation()}},onPressGroup:function(r){var l=[38,63232,40,63233],f=[37,63234,39,63235];if(r.keyCode===13){var p=this;window.setTimeout(function(){t.ckeditor.openGroupNameDialog(p,o(r.currentTarget))},0);r.preventDefault();r.stopPropagation()};if(e.indexOf(e.union(l,f),r.keyCode)>-1){var i=o(r.currentTarget),d=i.parent(),s=d.children(),n,a;if(e.indexOf(f,r.keyCode)>-1){n=s.index(i);if((e.indexOf([37,63234],r.keyCode)>-1)){if(n>0){i.insertBefore(s.eq(n-1))}
else{i.insertBefore(d.closest('.ckeditor-row').prev().find('.ckeditor-toolbar-groups').children().eq(-1))}}
else if(e.indexOf([39,63235],r.keyCode)>-1){if(!s.eq(n+1).hasClass('placeholder')){i.insertAfter(d.children().eq(n+1))}
else{d.closest('.ckeditor-row').next().find('.ckeditor-toolbar-groups').prepend(i)}}}
else if(e.indexOf(l,r.keyCode)>-1){a=(e.indexOf([38,63232],r.keyCode)>-1)?'prev':'next';i.closest('.ckeditor-row')[a]().find('.ckeditor-toolbar-groups').eq(0).prepend(i)};t.ckeditor.registerGroupMove(this,i);i.trigger('focus');r.preventDefault();r.stopPropagation()}}})})(jQuery,Drupal,Backbone,_);