(function(e,t,o,r){'use strict';t.ckeditor=t.ckeditor||{};t.behaviors.ckeditorAdmin={attach:function(r){var a=e(r).find('.ckeditor-toolbar-configuration').once('ckeditor-configuration');if(a.length){var n=a.find('.js-form-item-editor-settings-toolbar-button-groups').hide().find('textarea');a.append(o.ckeditor.toolbarAdmin);var d=t.ckeditor.models.Model=new t.ckeditor.Model({$textarea:n,activeEditorConfig:JSON.parse(n.val()),hiddenEditorConfig:o.ckeditor.hiddenCKEditorConfig});var i={model:d,el:e('.ckeditor-toolbar-configuration')};t.ckeditor.views={controller:new t.ckeditor.ControllerView(i),visualView:new t.ckeditor.VisualView(i),keyboardView:new t.ckeditor.KeyboardView(i),auralView:new t.ckeditor.AuralView(i)}}},detach:function(o,r,i){if(i!=='unload'){return};var d=e(o).find('.ckeditor-toolbar-configuration').findOnce('ckeditor-configuration');if(d.length&&t.ckeditor.models&&t.ckeditor.models.Model){var c=t.ckeditor.models.Model.toJSON().activeEditorConfig,n=t.ckeditor.views.controller.getButtonList(c),l=e('.ckeditor-toolbar-configuration').find('.ckeditor-toolbar-active');for(var a=0;a<n.length;a++){l.trigger('CKEditorToolbarChanged',['removed',n[a]])}}}};t.ckeditor={views:{},models:{},registerButtonMove:function(e,o,r){var i=o.closest('.ckeditor-toolbar-group');if(i.hasClass('placeholder')){if(e.isProcessing){return};e.isProcessing=!0;t.ckeditor.openGroupNameDialog(e,i,r)}
else{e.model.set('isDirty',!0);r(!0)}},registerGroupMove:function(t,o){var r=o.closest('.ckeditor-row');if(r.hasClass('placeholder')){r.removeClass('placeholder')};r.parent().children().each(function(){r=e(this);if(r.find('.ckeditor-toolbar-group').not('.placeholder').length===0){r.addClass('placeholder')}});t.model.set('isDirty',!0)},openGroupNameDialog:function(r,o,i){i=i||function(){};function l(o){if(o.elements[0].value.length===0){var r=e(o);if(!r.hasClass('errors')){r.addClass('errors').find('input').addClass('error').attr('aria-invalid','true');e('<div class="description" >'+t.t('Please provide a name for the button group.')+'</div>').insertAfter(o.elements[0])};return!0};return!1};function a(e,a){function d(){n.close(e);delete r.isProcessing};function c(e,o){if(e.hasClass('placeholder')){var r='ckeditor-toolbar-group-aria-label-for-'+t.checkPlain(o.toLowerCase().replace(/\s/g,'-'));e.removeAttr('aria-label').attr('data-drupal-ckeditor-type','group').attr('tabindex',0).children('.ckeditor-toolbar-group-name').attr('id',r).end().children('.ckeditor-toolbar-group-buttons').attr('aria-labelledby',r)};e.attr('data-drupal-ckeditor-toolbar-group-name',o).children('.ckeditor-toolbar-group-name').text(o)};if(e==='cancel'){d();i(!1,o);return};if(a&&l(a)){return};if(e==='apply'){d();c(o,t.checkPlain(a.elements[0].value));o.closest('.ckeditor-row.placeholder').addBack().removeClass('placeholder');i(!0,o);r.model.set('isDirty',!0)}};var d=e(t.theme('ckeditorButtonGroupNameForm')),n=t.dialog(d.get(0),{title:t.t('Button group name'),dialogClass:'ckeditor-name-toolbar-group',resizable:!1,buttons:[{text:t.t('Apply'),click:function(){a('apply',this)},primary:!0},{text:t.t('Cancel'),click:function(){a('cancel')}}],open:function(){var n=this,d=e(this),i=d.parent();i.find('.ui-dialog-titlebar-close').remove();i.on('keypress.ckeditor','input, button',function(t){if(t.keyCode===13){var i=e(t.currentTarget),o=i.data('ui-button'),r='apply';if(o&&o.options&&o.options.label){r=o.options.label.toLowerCase()};a(r,n);t.stopPropagation();t.stopImmediatePropagation();t.preventDefault()}});var r=t.t('Editing the name of the new button group in a dialog.');if(typeof o.attr('data-drupal-ckeditor-toolbar-group-name')!=='undefined'){r=t.t('Editing the name of the "@groupName" button group in a dialog.',{'@groupName':o.attr('data-drupal-ckeditor-toolbar-group-name')})};t.announce(r)},close:function(t){e(t.target).remove()}});n.showModal();e(document.querySelector('.ckeditor-name-toolbar-group').querySelector('input')).attr('value',o.attr('data-drupal-ckeditor-toolbar-group-name')).trigger('focus')}};t.behaviors.ckeditorAdminButtonPluginSettings={attach:function(t){var r=e(t),o=r.find('#ckeditor-plugin-settings').once('ckeditor-plugin-settings');if(o.length){o.find('[data-ckeditor-buttons]').each(function(){var t=e(this);if(t.data('verticalTab')){t.data('verticalTab').tabHide()}
else{t.hide()};t.data('ckeditorButtonPluginSettingsActiveButtons',[])});r.find('.ckeditor-toolbar-active').off('CKEditorToolbarChanged.ckeditorAdminPluginSettings').on('CKEditorToolbarChanged.ckeditorAdminPluginSettings',function(t,e,r){var i=o.find('[data-ckeditor-buttons~='+r+']');if(i.length===0){return};var n=i.data('verticalTab'),a=i.data('ckeditorButtonPluginSettingsActiveButtons');if(e==='added'){a.push(r);if(n){n.tabShow()}
else{i.show()}}
else{a.splice(a.indexOf(r),1);if(a.length===0){if(n){n.tabHide()}
else{i.hide()}}};i.data('ckeditorButtonPluginSettingsActiveButtons',a)})}}};t.theme.ckeditorRow=function(){return'<li class="ckeditor-row placeholder" role="group"><ul class="ckeditor-toolbar-groups clearfix"></ul></li>'};t.theme.ckeditorToolbarGroup=function(){var e='';e+='<li class="ckeditor-toolbar-group placeholder" role="presentation" aria-label="'+t.t('Place a button to create a new button group.')+'">';e+='<h3 class="ckeditor-toolbar-group-name">'+t.t('New group')+'</h3>';e+='<ul class="ckeditor-buttons ckeditor-toolbar-group-buttons" role="toolbar" data-drupal-ckeditor-button-sorting="target"></ul>';e+='</li>';return e};t.theme.ckeditorButtonGroupNameForm=function(){return'<form><input name="group-name" required="required"></form>'};t.theme.ckeditorButtonGroupNamesToggle=function(){return'<button class="link ckeditor-groupnames-toggle" aria-pressed="false"></button>'};t.theme.ckeditorNewButtonGroup=function(){return'<li class="ckeditor-add-new-group"><button aria-label="'+t.t('Add a CKEditor button group to the end of this row.')+'">'+t.t('Add group')+'</button></li>'}})(jQuery,Drupal,drupalSettings,_);