(function(t,e,o){'use strict';t.ckeditor.AuralView=e.View.extend({events:{'click .ckeditor-buttons a':'announceButtonHelp','click .ckeditor-multiple-buttons a':'announceSeparatorHelp','focus .ckeditor-button a':'onFocus','focus .ckeditor-button-separator a':'onFocus','focus .ckeditor-toolbar-group':'onFocus'},initialize:function(){this.listenTo(this.model,'change:isDirty',this.announceMove)},announceMove:function(t,a){if(!a){var n=document.activeElement||null;if(n){var e=o(n);if(e.hasClass('ckeditor-toolbar-group')){this.announceButtonGroupPosition(e)}
else if(e.parent().hasClass('ckeditor-button')){this.announceButtonPosition(e.parent())}}}},onFocus:function(t){t.stopPropagation();var a=o(t.target),e=o(t.currentTarget),n=e.parent();if(n.hasClass('ckeditor-button')||n.hasClass('ckeditor-button-separator')){this.announceButtonPosition(e.parent())}
else if(a.attr('role')!=='button'&&e.hasClass('ckeditor-toolbar-group')){this.announceButtonGroupPosition(e)}},announceButtonGroupPosition:function(o){var i=o.parent().children(),s=o.closest('.ckeditor-row'),u=s.parent().children(),r=i.index(o)+1,l=i.not('.placeholder').length,n=u.index(s)+1,a=u.not('.placeholder').length,e=t.t('@groupName button group in position @position of @positionCount in row @row of @rowCount.',{'@groupName':o.attr('data-drupal-ckeditor-toolbar-group-name'),'@position':r,'@positionCount':l,'@row':n,'@rowCount':a});if(r===1&&n===a){e+='\n';e+=t.t('Press the down arrow key to create a new row.')};t.announce(e,'assertive')},announceButtonPosition:function(o){var c=o.closest('.ckeditor-row'),p=c.parent().children(),d=o.closest('.ckeditor-buttons').children(),n=o.closest('.ckeditor-toolbar-group'),h=n.parent().children(),l=h.index(n)+1,b=h.not('.placeholder').length,a=d.index(o)+1,r=d.length,u=p.index(c)+1,i=p.not('.placeholder').length,s=(o.attr('data-drupal-ckeditor-type')==='separator')?'':t.t('button'),e;if(o.closest('.ckeditor-toolbar-disabled').length>0){e=t.t('@name @type.',{'@name':o.children().attr('aria-label'),'@type':s});e+='\n'+t.t('Press the down arrow key to activate.');t.announce(e,'assertive')}
else if(n.not('.placeholder').length===1){e=t.t('@name @type in position @position of @positionCount in @groupName button group in row @row of @rowCount.',{'@name':o.children().attr('aria-label'),'@type':s,'@position':a,'@positionCount':r,'@groupName':n.attr('data-drupal-ckeditor-toolbar-group-name'),'@row':u,'@rowCount':i});if(l===1&&a===1&&u===i){e+='\n';e+=t.t('Press the down arrow key to create a new button group in a new row.')};if(l===b&&a===r){e+='\n';e+=t.t('This is the last group. Move the button forward to create a new group.')};t.announce(e,'assertive')}},announceButtonHelp:function(e){var a=o(e.currentTarget),r=a.parent(),i=r.closest('.ckeditor-toolbar-active').length>0,n;if(i){n=t.t('The "@name" button is currently enabled.',{'@name':a.attr('aria-label')});n+='\n'+t.t('Use the keyboard arrow keys to change the position of this button.');n+='\n'+t.t('Press the up arrow key on the top row to disable the button.')}
else{n=t.t('The "@name" button is currently disabled.',{'@name':a.attr('aria-label')});n+='\n'+t.t('Use the down arrow key to move this button into the active toolbar.')};t.announce(n);e.preventDefault()},announceSeparatorHelp:function(e){var a=o(e.currentTarget),r=a.parent(),i=r.closest('.ckeditor-toolbar-active').length>0,n;if(i){n=t.t('This @name is currently enabled.',{'@name':a.attr('aria-label')});n+='\n'+t.t('Use the keyboard arrow keys to change the position of this separator.')}
else{n=t.t('Separators are used to visually split individual buttons.');n+='\n'+t.t('This @name is currently disabled.',{'@name':a.attr('aria-label')});n+='\n'+t.t('Use the down arrow key to move this separator into the active toolbar.');n+='\n'+t.t('You may add multiple separators to each button group.')};t.announce(n);e.preventDefault()}})})(Drupal,Backbone,jQuery);