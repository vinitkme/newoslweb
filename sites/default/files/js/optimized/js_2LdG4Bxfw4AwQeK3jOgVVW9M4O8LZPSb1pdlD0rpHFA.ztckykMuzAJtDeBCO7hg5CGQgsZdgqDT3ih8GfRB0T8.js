(function(t,e,i){'use strict';function o(e){var i=e.attr('data-editor-for');return t('#'+i).get(0)};function r(r,o){var d=r.getAttribute('data-editor-active-text-format');if(i.editor.formats[d]){e.editorDetach(r,i.editor.formats[d])}
else{t(r).off('.editor')};if(i.editor.formats[o]){var n=i.editor.formats[o];a(r,n,d,e.editorAttach)};r.setAttribute('data-editor-active-text-format',o)};function d(o){var f=t(o.target),d=o.data.field,s=d.getAttribute('data-editor-active-text-format'),a=f.val();if(a===s){return};var l=i.editor.formats[a]&&i.editor.formats[a].editorSupportsContentFiltering,c=d.value!=='';if(c&&l){var u=e.t('Changing the text format to %text_format will permanently remove content that is not allowed in that text format.<br><br>Save your changes before switching the text format to avoid losing data.',{'%text_format':f.find('option:selected').text()});var n=e.dialog('<div>'+u+'</div>',{title:e.t('Change text format?'),dialogClass:'editor-change-text-format-modal',resizable:!1,buttons:[{text:e.t('Continue'),class:'button button--primary',click:function(){r(d,a);n.close()}},{text:e.t('Cancel'),class:'button',click:function(){f.val(s);n.close()}}],closeOnEscape:!1,create:function(){t(this).parent().find('.ui-dialog-titlebar-close').remove()},beforeClose:!1,close:function(e){t(e.target).remove()}});n.showModal()}
else{r(d,a)}};e.editors={};e.behaviors.editor={attach:function(i,r){if(!r.editor){return};t(i).find('[data-editor-for]').once('editor').each(function(){var a=t(this),i=o(a);if(!i){return};var n=a.val();i.setAttribute('data-editor-active-text-format',n);if(r.editor.formats[n]){e.editorAttach(i,r.editor.formats[n])};t(i).on('change.editor keypress.editor',function(){i.setAttribute('data-editor-value-is-changed','true');t(i).off('.editor')});if(a.is('select')){a.on('change.editorAttach',{field:i},d)};a.parents('form').on('submit',function(t){if(t.isDefaultPrevented()){return};if(r.editor.formats[n]){e.editorDetach(i,r.editor.formats[n],'serialize')}})})},detach:function(i,r,a){var d;if(a==='serialize'){d=t(i).find('[data-editor-for]').findOnce('editor')}
else{d=t(i).find('[data-editor-for]').removeOnce('editor')};d.each(function(){var n=t(this),d=n.val(),i=o(n);if(i&&d in r.editor.formats){e.editorDetach(i,r.editor.formats[d],a)}})}};e.editorAttach=function(i,r){if(r.editor){e.editors[r.editor].attach(i,r);e.editors[r.editor].onChange(i,function(){t(i).trigger('formUpdated');i.setAttribute('data-editor-value-is-changed','true')})}};e.editorDetach=function(t,i,r){if(i.editor){e.editors[i.editor].detach(t,i,r);if(t.getAttribute('data-editor-value-is-changed')==='false'){t.value=t.getAttribute('data-editor-value-original')}}};function a(i,r,o,a){if(r.editor.isXssSafe){a(i,r)}
else{t.ajax({url:e.url('editor/filter_xss/'+r.format),type:'POST',data:{value:i.value,original_format_id:o},dataType:'json',success:function(t){if(t!==!1){i.value=t};a(i,r)}})}}})(jQuery,Drupal,drupalSettings);