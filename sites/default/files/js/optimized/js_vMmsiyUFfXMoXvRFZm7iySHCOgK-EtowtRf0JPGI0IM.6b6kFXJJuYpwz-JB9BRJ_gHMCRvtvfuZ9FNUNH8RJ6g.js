(function(e,i){'use strict';i.behaviors.fileValidateAutoAttach={attach:function(n,a){var f=e(n),t;function o(e){f.find(e).once('fileValidate').on('change.fileValidate',{extensions:t[e]},i.file.validateExtension)};if(a.file&&a.file.elements){t=a.file.elements;Object.keys(t).forEach(o)}},detach:function(n,a,o){var l=e(n),t;function f(e){l.find(e).removeOnce('fileValidate').off('change.fileValidate',i.file.validateExtension)};if(o==='unload'&&a.file&&a.file.elements){t=a.file.elements;Object.keys(t).forEach(f)}}};i.behaviors.fileAutoUpload={attach:function(n){e(n).find('input[type="file"]').once('auto-file-upload').on('change.autoFileUpload',i.file.triggerUploadButton)},detach:function(i,n,a){if(a==='unload'){e(i).find('input[type="file"]').removeOnce('auto-file-upload').off('.autoFileUpload')}}};i.behaviors.fileButtons={attach:function(n){var a=e(n);a.find('.js-form-submit').on('mousedown',i.file.disableFields);a.find('.js-form-managed-file .js-form-submit').on('mousedown',i.file.progressBar)},detach:function(n){var a=e(n);a.find('.js-form-submit').off('mousedown',i.file.disableFields);a.find('.js-form-managed-file .js-form-submit').off('mousedown',i.file.progressBar)}};i.behaviors.filePreviewLinks={attach:function(n){e(n).find('div.js-form-managed-file .file a').on('click',i.file.openInNewWindow)},detach:function(n){e(n).find('div.js-form-managed-file .file a').off('click',i.file.openInNewWindow)}};i.file=i.file||{validateExtension:function(n){n.preventDefault();e('.file-upload-js-error').remove();var a=n.data.extensions.replace(/,\s*/g,'|');if(a.length>1&&this.value.length>0){var o=new RegExp('\\.('+a+')$','gi');if(!o.test(this.value)){var t=i.t('The selected file %filename cannot be uploaded. Only files with the following extensions are allowed: %extensions.',{'%filename':this.value.replace('C:\\fakepath\\',''),'%extensions':a.replace(/\|/g,', ')});e(this).closest('div.js-form-managed-file').prepend('<div class="messages messages--error file-upload-js-error" aria-live="polite">'+t+'</div>');this.value='';n.stopImmediatePropagation()}}},triggerUploadButton:function(i){e(i.target).closest('.js-form-managed-file').find('.js-form-submit').trigger('mousedown')},disableFields:function(i){var n=e(this).findOnce('ajax');if(!n.length){return};var t=[];if(n.closest('div.js-form-managed-file').length>0){t=n.closest('div.js-form-managed-file').find('input.js-form-file')};var a=e('div.js-form-managed-file input.js-form-file').not(t).not(':disabled');a.prop('disabled',!0);setTimeout(function(){a.prop('disabled',!1)},1000)},progressBar:function(i){var t=e(this),n=t.closest('div.js-form-managed-file').find('input.file-progress');if(n.length){var a=n.attr('name');n.attr('name',a.match(/APC_UPLOAD_PROGRESS|UPLOAD_IDENTIFIER/)[0]);setTimeout(function(){n.attr('name',a)},1000)};setTimeout(function(){t.closest('div.js-form-managed-file').find('div.ajax-progress-bar').slideDown()},500)},openInNewWindow:function(i){i.preventDefault();e(this).attr('target','_blank');window.open(this.href,'filePreview','toolbar=0,scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,width=500,height=550')}}})(jQuery,Drupal);